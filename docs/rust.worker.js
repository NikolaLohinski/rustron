!function(e){self.webpackChunk=function(t,n){for(var o in n)e[o]=n[o];for(;t.length;)r[t.pop()]=1};var t={},r={0:1},n={};var o={3:function(){return{"./bot":{__wbg_self_9a26b723fa225e67:function(e){return t[2].exports.__wbg_self_9a26b723fa225e67(e)},__wbindgen_object_drop_ref:function(e){return t[2].exports.__wbindgen_object_drop_ref(e)},__wbg_require_147b1d56aa2783f2:function(e,r){return t[2].exports.__wbg_require_147b1d56aa2783f2(e,r)},__wbg_crypto_96abeab5f10f5480:function(e){return t[2].exports.__wbg_crypto_96abeab5f10f5480(e)},__wbindgen_is_undefined:function(e){return t[2].exports.__wbindgen_is_undefined(e)},__wbg_getRandomValues_b7c2e07d4a48024c:function(e){return t[2].exports.__wbg_getRandomValues_b7c2e07d4a48024c(e)},__wbg_getRandomValues_3295060463ee4561:function(e,r,n){return t[2].exports.__wbg_getRandomValues_3295060463ee4561(e,r,n)},__wbg_randomFillSync_d905e73814080d28:function(e,r,n){return t[2].exports.__wbg_randomFillSync_d905e73814080d28(e,r,n)},__wbg_act_b707998cb6555007:function(e,r,n,o,i){return t[2].exports.__wbg_act_b707998cb6555007(e,r,n,o,i)},__wbindgen_throw:function(e,r){return t[2].exports.__wbindgen_throw(e,r)},__wbindgen_defer_start:function(){return t[2].exports.__wbindgen_defer_start()}}}}};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[];return t.push(Promise.resolve().then(function(){r[e]||importScripts(e+".rust.worker.js")})),({1:[3]}[e]||[]).forEach(function(e){var r=n[e];if(r)t.push(r);else{var s,a=o[e](),u=fetch(i.p+""+{3:"5d8d6427c56e17bd35bf"}[e]+".module.wasm");if(a instanceof Promise&&"function"==typeof WebAssembly.compileStreaming)s=Promise.all([WebAssembly.compileStreaming(u),a]).then(function(e){return WebAssembly.instantiate(e[0],e[1])});else if("function"==typeof WebAssembly.instantiateStreaming)s=WebAssembly.instantiateStreaming(u,a);else{s=u.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,a)})}t.push(n[e]=s.then(function(t){return i.w[e]=(t.instance||t).exports}))}}),Promise.all(t)},i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.w={},i(i.s=1)}([function(e,t,r){"use strict";class n{constructor(){this.register=(()=>{throw Error("AI has not been initialized")})}init(e,t){return new Promise(t=>{this.register=e,t()})}play(e){throw Error("not implemented")}}r.d(t,"b",function(){return s}),r.d(t,"a",function(){return a});const o=2;let i;function s(e,t,r){i(e,t,r)}class a extends n{init(e,t){return new Promise(n=>{i=e,this.maxDepth=t.depth?t.depth:o,r.e(1).then(r.bind(null,2)).then(e=>{this.module=e,n()})})}play(e){return new Promise(t=>{e.position.prev||(e.position.prev=e.position);const r=this.module.Position.new(e.position.x,e.position.y,e.position.prev.x,e.position.prev.y),n=this.module.Grid.new(e.grid.sizeX,e.grid.sizeY,e.grid.toJson());this.module.play(e.correlationID,r,n,this.maxDepth),t()})}}},function(e,t,r){"use strict";var n,o;r.r(t),function(e){e.MESSAGE="message",e.ERROR="error"}(n||(n={})),function(e){e.BOOT="BOOT",e.REQUEST="REQUEST",e.RESULT="RESULT",e.IDLE="IDLE",e.ERROR="ERROR"}(o||(o={}));class i{static parse(e){const t=new i(e.sizeX,e.sizeY);return t.filled=e.filled,t}static key(e){return`${e.x}-${e.y}`}constructor(e,t){this.sizeX=e,this.sizeY=t,this.filled={}}isEmpty(){return 0===Object.keys(this.filled).length}reset(){this.filled={}}toJson(){return JSON.stringify(this.filled)}getCell(e){return this.filled[i.key(e)]}setCell(e,t){this.getCell(t)||(this.filled[i.key(t)]=[]),this.filled[i.key(t)].push(e)}}var s=r(0);const a=self,u=new class{constructor(e,t){this.ctx=e,this.player=t}handleWEvent(e){const t=e.data;this.handleWMessage(t).then(e=>{e&&this.ctx.postMessage(e)}).catch(e=>{const r={workerID:t.workerID,correlationID:t.correlationID,type:o.ERROR,error:e.toString()};console.error(e),this.ctx.postMessage(r)})}handleWMessage(e){return new Promise(t=>{switch(e.type){case o.BOOT:const r=(t,r,n)=>{const i={correlationID:t,type:o.RESULT,workerID:e.workerID,origin:o.REQUEST,depth:n,move:r};this.ctx.postMessage(i)};this.player.init(r,e.parameters).then(()=>{t({workerID:e.workerID,correlationID:e.correlationID,origin:o.BOOT,type:o.IDLE})});break;case o.REQUEST:this.player.play({correlationID:e.correlationID,userID:e.userID,position:e.position,grid:i.parse(e.grid)}).then(()=>{const r={workerID:e.workerID,correlationID:e.correlationID,origin:o.REQUEST,type:o.IDLE};t(r)});break;default:throw Error(`unknown message of type '${e.type}'`)}})}}(a,new s.a);a.onmessage=u.handleWEvent.bind(u)}]);